/** tt.js version:1.0.1 author:kei takahashi(twitter@dameleon) at:2013-05-05 */
(function(t,e,n){"use strict";function r(t,r){var i=null,s="";if("string"==typeof t)s=t,r=r||e,i=C.test(t)?r.querySelectorAll(t):"#"===t[0]?[r.getElementById(t.substring(1,t.length))]:"."===t[0]?r.getElementsByClassName(t.substring(1,t.length)):r.getElementsByTagName(t);else if(t)if(1===t.nodeType)i=[t];else if(o(t)||Array.isArray(t)&&t.length&&t[0].nodeType)i=t;else if(t===e||t===e.body)i=[e.body];else{if("function"==typeof t)return O?t():w.push(t),n;if(t instanceof T)return t}return new T(i||[],s)}function i(t,e){var n,r,i,s=0;if(Array.isArray(t))for(i=t.length;i>s;++s)e(t[s],s);else if("object"==typeof t)for(n=Object.keys(t),i=n.length;i>s;++s)r=n[s],e(r,t[r])}function s(){function t(t){c&&u(n[t],"object")&&u(e[t],"object")?s(n[t],e[t]):n[t]=e[t]}var e,n,r=b(arguments),a=1,o=r.length,c=!1;for(r[0]===!0&&(c=!0,++a),n=r[a-1]||{};o>a;++a)e=r[a],"object"===u(e)&&i(Object.keys(e),t);return n}function a(t,e){var n,r,i,s={},a=0;if(Array.isArray(t)){for(i=t.length;i>a;++a)if(e(t[a],a))return t[a]}else if("object"==typeof t)for(n=Object.keys(t),i=n.length;i>a;++a)if(r=n[a],e(r,t[r],a))return s[r]=t[r],s;return null}function o(t){var e=Object.prototype.toString.call(t);return"[object NodeList]"===e||"[object HTMLCollection]"===e}function u(r,i){var s=null===r?"null":r===void 0?"undefined":r===t?"global":r===e?"document":r.nodeType?"node":Array.isArray(r)?"array":o(r)?"nodelist":n;if(s||(s=typeof r,"object"===s&&(s=Object.prototype.toString.call(r).toLowerCase().match(/.*\s([a-z]*)\]/)[1])),i){if(Array.isArray(i)){for(var a=0,u=i.length;u>a;++a)if(i[a]===s)return!0;return!1}return i===s}return s}function c(t,n){function r(t){if(!a){a=!0;var e,r=n.context;if(t>=200&&400>t){try{e=o.response||o.responseText}catch(i){e=o.responseText}"json"===n.dataType&&u(e,"string")&&(e=g(e)),n.success&&n.success.apply(r,[e,t,o])}else n.error&&n.error.apply(r,[o,t]);n.complete&&n.complete.apply(r,[o,t]),o=null}}var a=!1,o=new XMLHttpRequest;if(n=n||{},u(t,"object"))n=t;else{if(!u(t,"string"))throw Error("Error: missing argument");n.url=t}if(n=s({async:!0,beforeSend:null,cache:!0,complete:null,contentType:"application/x-www-form-urlencoded; charset=UTF-8",context:e.body,data:null,dataType:"text",error:null,headers:null,mimeType:null,success:null,timeout:0,type:"GET",url:"",user:"",password:""},n),n.type=n.type.toUpperCase(),n.data&&"GET"===n.type?(n.url=n.url+n.url.indexOf("?")>-1?"&":"?"+p(n.data),n.data=null):n.data=p(n.data),o.onerror=function(){r(0)},o.onreadystatechange=function(){4===o.readyState&&r(o.status)},o.open(n.type,n.url,n.async,n.user,n.password),"POST"===n.type&&(o.setRequestHeader("Content-type",n.contentType),o.setRequestHeader("Content-length",n.data.length)),u(n.headers,"object")&&i(n.headers,function(t,e){o.setRequestHeader(t,e)}),n.dataType)try{o.responseType=n.dataType}catch(c){o.responseType="text"}return n.mimeType&&o.overrideMimeType(n.mimeType),n.beforeSend&&n.beforeSend(o),n.timeout&&(o.timeout=n.timeout),o.send(n.data),o}function h(e){function n(t){if(!t)return null;var e,n=4,r=0;return t=t.replace(/\D/g,""),r=n-t.length,e=r>0?+t*Math.pow(10,r):+t}var r={},i=(e||t.navigator).userAgent.toLowerCase();return r.android=/android/.test(i),r.ios=/ip(hone|od|ad)/.test(i),r.android||r.ios||(r.windowsPhone=/windows\sphone/.test(i),r.ie=/msie/.test(i)),r.chrome=/(chrome|crios)/.test(i),r.firefox=/firefox/.test(i),r.opera=/opera/.test(i),r.androidBrowser=!r.chrome&&r.android&&/applewebkit/.test(i),r.mobileSafari=!r.chrome&&r.ios&&/applewebkit/.test(i),r.version=r.androidBrowser||r.android&&r.chrome?i.match(/android\s(\S.*?)\;/):r.mobileSafari||r.ios&&r.chrome?i.match(/os\s(\S.*?)\s/):null,r.version=r.version?r.ios?r.version[1].replace("_","."):r.version[1]:null,r.versionCode=n(r.version),r.supportTouch="ontouchstart"in t,r}function l(t){if(!t||"string"!=typeof t)throw Error("Argument error");var e="";return"-"===t[0]&&(t=t.substr(1,t.length)),r.each(t.split("-"),function(t,r){return r?(e+=t[0].toUpperCase()+t.substr(1,t.length),n):(e+=t,n)}),e||t}function f(t,e){var n=[];return e=e||["webkit","moz","o","ms","khtml"],i(e,function(e,r){n[r]="-"+e+"-"+t}),n}function d(t){if(!t||"string"!=typeof t)throw Error("Argument error");var e=["webkit","moz","o","ms","khtml"],r=/[A-Z]/g,s=t.match(r),a="";return i(t.split(r),function(t,r){return e.indexOf(t)>-1?(a+="-"+t,n):r?(a+="-"+s.shift().toLowerCase()+t,n):(a+=t,n)}),a||t}function p(t){if(!u(t,"object"))return t;for(var e,n=Object.keys(t),r=0,i=n.length,s=[];i>r;++r)e=n[r],s.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return s.join("&")}function g(t){if(!t)return{};if("object"==typeof t)return t;var e;try{return e=JSON.parse(t)}catch(n){}try{e=Function("return "+t)()}catch(r){throw Error("Can't parse text to json")}return e}function v(){if(2>arguments.length)throw Error("Missing argument error");var t,e=b(arguments),n=e.shift(),r=e.shift();return"string"==typeof r&&(t=n[r],r=n,n=t),function(){return n.apply(r,e.concat(b(arguments)))}}function y(t){if(!u(t,"string"))return{};"?"===t[0]&&(t=t.substr(1,t.length));for(var e={},n=t.split("&"),r=0,i=n.length;i>r;++r){var s=n[r].split("=");e[s[0]]=s[1]}return e}function m(t,n){if(!t||"string"!=typeof t)throw Error("Argument error");var i=e.createElement(t);return n?r(i):i}function b(t){return[].slice.call(t)}function E(t,r,i,s,a){if(!t||!r)throw Error("Missing argument error");u(i,"string")||(i=r,r="click"===i?"MouseEvents":"Event");var o=e.createEvent(r);o.initEvent(i,s!==n?s:!0,a!==n?a:!0),t.dispatchEvent(o)}function T(t,e){var n,r=0;for(this.selector=e,this.length=n=t.length,this._events={},this._delegates={},this._data={};n>r;++r)this[r]=t[r];return this}var _="tt",C=/^(.+[\#\.\s\[\*>:,]|[\[:])/,O=!1,w=[],A=h(t.navigator),j=e.createElement("div");e.addEventListener("DOMContentLoaded",function(){O=!0;for(var t=0,e=w.length;e>t;++t)w[t]()},!1),Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(i){if("object"!=typeof i&&"function"!=typeof i||null===i)throw new TypeError("Object.keys called on non-object");var s=[];for(var a in i)t.call(i,a)&&s.push(a);if(e)for(var o=0;r>o;o++)t.call(i,n[o])&&s.push(n[o]);return s}}()),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Node.contains||(Node.contains=function(t){var e=this.compareDocumentPosition(t);return 0===e||e&Node.DOCUMENT_POSITION_CONTAINED_BY}),r.ajax=c,r.createEnvData=h,r.camelizer=l,r.hyphenizer=d,r.cssPrefix=f,r.each=i,r.extend=s,r.env=A,r.isArray=Array.isArray,r.isNodeList=o,r.match=a,r.param=p,r.parseJSON=g,r.proxy=v,r.query2object=y,r.tag=m,r.toArray=b,r.triggerEvent=E,r.type=u,r.fn=T.prototype={constructor:T,get:function(t){return this[t||0]},toArray:function(){var t=[];return this.each(function(e){t[e]=this}),t},each:function(t){for(var e=0,n=this.length;n>e;++e)t.call(this[e],e);return this},match:function(t){for(var e=0,n=this.length;n>e;++e)if(t.call(this[e],e))return this[e];return null},push:function(t){if(t&&t.nodeType)this[this.length]=t,++this.length;else if(u(t,["array","nodelist"]))for(var e=0,n=t.length;n>e;++e)this[this.length]=t[e],++this.length;return this},indexOf:function(t){var e=-1;return this.match(function(n){return this===t?(e=n,!0):!1}),e},on:function(t,e,n){return u(e,"string")?this.delegate(t,e,n):this.bind(t,e)},off:function(t,e,n){return u(e,"string")?this.undelegate(t,e,n):this.unbind(t,e)},bind:function(t,e,n){n=n||!1;var r=this._events[t];return r||(r=this._events[t]={},r.callbacks=[],r.handler=function(t){var e=t._tt_data,n=Array.isArray(e)?[].concat(e):[];n.unshift(t),i(r.callbacks,function(e){"function"==typeof e?e.apply(t.currentTarget,n):e&&e.handleEvent&&e.handleEvent.apply(t.currentTarget,n)})},this.each(function(){this.addEventListener(t,r.handler,n)})),r.callbacks.push(e),this},unbind:function(t,e){var n=this._events[t],r=n?n.callbacks.indexOf(e):-1;if(n&&!(0>r))return n.callbacks.splice(r,1),n.callbacks.length||this.each(function(){this.removeEventListener(t,n.handler)}),this},delegate:function(t,e,n){var i=this._delegates[t],s={target:e,callback:n};return i||(i=this._delegates[t]={},i.listeners=[],i.handler=function(t){var e=t.target,n=arguments;a(i.listeners,function(t){var i=r(t.target).match(function(){return this.contains(e)?!0:!1});return i?("function"==typeof t.callback?t.callback.apply(i,n):t.callback.handleEvent&&t.callback.handleEvent.apply(i,n),!0):!1})},this.bind(t,i.handler)),i.listeners.push(s),this},undelegate:function(t,e,n){var r=this._delegates[t],i=r.listeners;return i&&0!==i.length?(a(i,function(t,r){return t.target===e&&t.callback===n?(i.splice(r,1),!0):!1}),0===i.length&&(this.unbind(t,r.handler),this._delegates[t]={}),this):this},addClass:j.classList?function(t){return this.each(function(){this.classList.add(t)})}:function(t){function e(t,e){var n=t.split(" ");return n[n.length]=e,n.join(" ")}var n=this[0].className,i=e(n,t);return this.each(function(s){r(this).hasClass(t)||(s&&n!==this.className&&(n=this.className,i=e(n,t)),this.className=i)})},removeClass:j.classList?function(t){return this.each(function(){this.classList.remove(t)})}:function(t){var e,n;return t=" "+t+" ",this.each(function(){this.className===e?this.className=n:(e=this.className,this.className=n=(" "+e+" ").replace(t," ").trim())})},hasClass:j.classList?function(t){return this.match(function(){return this.classList.contains(t)})}:function(t){return t=" "+t,this.match(function(){return(" "+this.className).indexOf(t)>-1})},toggleClass:function(t,e){var n=this;return e?n.each(function(){var e=r(this);e.hasClass(t)?e.removeClass(t):e.addClass(t)}):r(n[0]).hasClass(t)?n.removeClass(t):n.addClass(t),this},find:function(t){var e=[];return this.each(function(){e=e.concat(r(t,this).toArray())}),r(e)},contains:function(t){var e=r(),n=r(t);return this.each(function(){var t=this,r=n.match(function(){return t.contains(this)});r&&e.push(this)}),e},attr:function(t,e){function r(t,e){(e===n||null===e)&&(e=""),s.each(function(){return""===e?(this.removeAttribute(t),n):(this.setAttribute(t,e),n)})}var s=this;switch(arguments.length){case 0:var a,o=this[0].attributes;t={};for(var u=0,c=o.length;c>u;++u)a=o[u],t[a.nodeName]=a.nodeValue;return t;case 1:if("object"!=typeof t)return this[0].getAttribute(t);i(t,function(e){r(e,t[e])});break;case 2:r(t,e)}return this},html:function(t){if(t===n||null===t)return this[0].innerHTML;var e,r=0,i=this.length;if(t.nodeType)this.clear().append(t);else for(;i>r;++r){for(e=this[r];e.firstChild;)e.removeChild(e.firstChild);e.insertAdjacentHTML("afterbegin",t)}return this},append:function(t){var e=this,n=0,r=e.length,i=r>1;if(t.nodeType)for(;r>n;++n)e[n].appendChild(i?t.cloneNode(!0):t);else t instanceof T&&t.each(function(){e.appendChild(this)});return this},prepend:function(t){var e,n=this,r=0,i=n.length,s=i>1;if(t.nodeType)for(;i>r;++r)e=n[r],e.insertBefore(s?t.cloneNode(!0):t,e.firstChild);else t instanceof T&&t.each(function(){n.insertBefore(this,n.firstChild)});return this},remove:function(){for(var t,e=0,n=this.length;n>e;++e)t=this[e],t.parentNode.removeChild(t);return this},clear:function(){for(var t,e=0,n=this.length;n>e;++e)for(t=this[e];t.firstChild;)t.removeChild(t.firstChild);return this},parent:function(t){var e,n=r(),i=0,s=this.length;if(t)for(var a=r(t).toArray();s>i;++i)e=this[i],a.indexOf(e.parentNode)>-1&&n.push(e.parentNode);else for(;s>i;++i)n.push(this[i].parentNode);return n},parents:function(t){var e,n=this;return t?(e=r(),r(t).each(function(){var t=this,r=n.match(function(){var e=t.compareDocumentPosition(this);return e&Node.DOCUMENT_POSITION_CONTAINED_BY});r&&e.push(this)})):(e=[],this.match(function(){for(var t=this;null!==(t=t.parentNode);){if(!(0>e.indexOf(t)))return!0;e.push(t)}return!1}),e=r(e)),e},closest:function(t){var e,n,i=[],s=0,a=this.length;if(!t)return r();for(e=r(t).toArray();a>s;++s)for(n=this[s];n;){if(e.indexOf(n)>-1){-1===i.indexOf(n)&&i.push(n);break}n=n.parentNode}return r(i)},children:function(t){var e,n,i,s,a=0,o=this.length;if(t)for(e=r(),n=r(t);o>a;++a)i=b(this[a].children),s=i.length,n.each(function(){for(var t,n=0;s>n;++n)t=i[n],this===t&&e.push(t)});else{for(e=[];o>a;++a)e=e.concat(b(this[a].children));e=r(e)}return e},replace:function(t){for(var e=this,n=0,r=e.length,i="string"==typeof t?function(e){e.insertAdjacentHTML("beforebegin",t)}:function(e){e.parentNode.insertBefore(t,e)};r>n;++n)i(e[n]);return e.remove()},css:function(e,r){function s(t){for(var e=0,n=o.length;n>e;++e)o[e].style.removeProperty(t)}function a(t,e){for(var n=0,r=o.length;r>n;++n)o[n].style[t]=e}var o=this;if("object"==typeof e)i(e,function(t,e){return""===e?(s(t),n):(a(l(t),e),n)});else{if(!e)return t.getComputedStyle(o[0]);if(r)a(l(e),r);else{if(""!==r)return t.getComputedStyle(o[0]).getPropertyValue(e);s(e)}}return this},data:function(){function t(t,e){var r=u(e),i=0,s=this.length;if(""===e||"undefined"===r||"null"===r){if(this._data[t])return delete this._data[t],n;for(t=l(t);s>i;++i)delete this[i].dataset[t]}else{if("string"!==r&&"number"!==r)return this._data[t]=e,n;for(t=l(t);s>i;++i)this[i].dataset[t]=e}}function e(t){if(!this[0])return null;var e=this,r=e[0],s={};return t?e._data[t]?e._data[t]||null:r.dataset[l(t)]||null:(i(r.dataset,function(t,r){t=d(t),s[t]=e._data[t]!==n?e._data[t]:r}),s)}function r(t,e){var r="data-",i=u(e);if(""===e||"undefined"===i||"null"===i){if(this._data[t])return delete this._data[t],n;this.attr(r+t,null)}else"string"===i||"number"===i?this.attr(r+t,e):this._data[t]=e}function s(t){if(!this[0])return null;var e,n={},r="data-",s=this[0],a=s.attributes,o=0,u=a.length;if(!s)return null;if(this._data[t])return this._data[t];if(t)return this.attr(r+t);for(;u>o;++o)e=a[o].name,e.indexOf(r)>-1&&(t=e.substr(5,e.length),n[t]=a[o].value);return i(this._data,function(t,e){n[t]=e}),n}var a=j.dataset,o=a?e:s,c=a?t:r;return function(t,e){var n=this;switch(arguments.length){case 0:return o.call(n);case 1:return"object"==typeof t?(i(t,function(t,e){c.call(n,d(t),e)}),n):o.call(n,d(t));case 2:return c.call(n,d(t),e),n}}}(),val:function(t){var e,r=0,i=this.length;if(t!==n){for(;i>r;++r)e=this[r],e.value!==n&&(e.value=t);return this}for(var s=[];i>r;++r)e=this[r],e.value!==n&&(s[r]=e.value);return this.length>1?s:s[0]},show:function(t){var e=this.css("display"),n=this._data.lastDisplay||null;if("none"===e)return this.css("display",t||n||"block")},hide:function(){var t=this.css("display");return"none"!==t&&(this._data.lastDisplay=t),this.css("display","none")},trigger:function(){var t=b(arguments),n=t.shift(),r=e.createEvent("Event"),i=0,s=this.length;for(r.initEvent(n,!0,!0),t.length>1&&(r._tt_data=t);s>i;++i)this[i].dispatchEvent(r);return this},offset:function(){for(var e=[],n=0,r=this.length;r>n;++n){var i=this[n].getBoundingClientRect();e[n]={left:i.left+t.pageXOffset,top:i.top+t.pageYOffset}}return 1===this.length?e[0]:e},width:function(t){return this[t||0].offsetWidth},height:function(t){return this[t||0].offsetHeight}},t[_]=t[_]||r})(this.self||global,document),function(t,e,n){function r(t){return{x:i(t,"pageX"),y:i(t,"pageY")}}function i(t,e){return a?t.changedTouches[0][e]:t[e]}function s(t,n,r,i){setTimeout(function(){var s=e.createEvent("Event");s.initEvent(n,!0,!0),s.pageX=r,s.pageY=i,t.dispatchEvent(s)})}var a="ontouchstart"in e,o={touchStart:a?"touchstart":"mousedown",touchMove:a?"touchmove":"mousemove",touchEnd:a?"touchend":"mouseup"},u={timeout:300},c={threshold:n.env.android?50:30,startPoint:null,currentTarget:null,handleEvent:function(t){switch(t.type){case o.touchMove:this.startPoint&&this._touchMove(t);break;case o.touchStart:this._touchStart(t);break;case o.touchEnd:this.startPoint&&this._touchEnd(t)}},_touchStart:function(t){var e=this;this.startPoint=r(t),this.currentTarget=t.target,setTimeout(function(){e._clear()},u.timeout),s(this.currentTarget,"touch",this.startPoint.x,this.startPoint.y)},_touchMove:function(){},_touchEnd:function(t){var e=r(t);this.threshold<Math.abs(this.startPoint.x-e.x)&&this.threshold<Math.abs(this.startPoint.y-e.y)?this._clear():s(this.currentTarget,"tap",e.x,e.y)},_clear:function(){this.startPoint=null,this.currentTarget=null}};e.addEventListener(o.touchStart,c,!1),e.addEventListener(o.touchEnd,c,!1)}(this,document,this.tt);